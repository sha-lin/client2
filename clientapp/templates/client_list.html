{% extends 'base.html' %}

{% block title %}Client List - Client MIS{% endblock %}

{% block content %}
<div>
<div class="space-y-6">
    <div>
        <h1 class="text-2xl font-semibold text-gray-900">Client List</h1>
        <p class="text-gray-600">Manage and view all client profiles</p>
    </div>
    
    <div class="card">
        <div class="border-b border-gray-200 px-6 py-4">
            <h3 class="text-lg font-semibold">All Clients</h3>
            <p class="text-sm text-gray-600">{{ clients|length }} client{{ clients|length|pluralize }} found</p>
        </div>
        <div class="p-6 space-y-4">
            <!-- Filters -->
            <form method="get" class="flex flex-wrap gap-4">
                <div class="flex items-center gap-2 flex-1 min-w-[300px]">
                    <svg class="w-4 h-4 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>
                    <input type="text" name="search" value="{{ search_query }}" placeholder="Search by name, company, email, or ID..." class="form-input flex-1">
                </div>
                <select name="type" class="form-select w-[150px]">
                    <option value="All" {% if filter_type == 'All' %}selected{% endif %}>All Types</option>
                    <option value="B2B" {% if filter_type == 'B2B' %}selected{% endif %}>B2B Only</option>
                    <option value="B2C" {% if filter_type == 'B2C' %}selected{% endif %}>B2C Only</option>
                </select>
                <select name="status" class="form-select w-[150px]">
                    <option value="All" {% if filter_status == 'All' %}selected{% endif %}>All Status</option>
                    <option value="Active" {% if filter_status == 'Active' %}selected{% endif %}>Active</option>
                    <option value="Dormant" {% if filter_status == 'Dormant' %}selected{% endif %}>Dormant</option>
                    <option value="Inactive" {% if filter_status == 'Inactive' %}selected{% endif %}>Inactive</option>
                </select>
                <button type="submit" class="btn btn-primary">Filter</button>
            </form>
            
            <!-- Table -->
            <div class="border border-gray-200 rounded-lg overflow-hidden">
                <table>
                    <thead class="bg-gray-50">
                        <tr>
                            <th>ID</th>
                            <th>Client</th>
                            <th>Type</th>
                            <th>Contact</th>
                            <th>Payment Terms</th>
                            <th>Jobs</th>
                            <th>Last Activity</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for client in clients %}
                        <tr>
                            <td>{{ client.client_id }}</td>
                            <td>
                                <div>
                                    <div class="font-medium">{{ client.name }}</div>
                                    {% if client.company %}
                                    <div class="text-sm text-gray-600">{{ client.company }}</div>
                                    {% endif %}
                                </div>
                            </td>
                            <td>
                                {% if client.client_type == 'B2B' %}
                                <span class="badge badge-secondary">
                                    <svg class="w-3 h-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 21h18"></path><path d="M3 10h18"></path><path d="M5 6h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z"></path></svg>
                                    B2B
                                </span>
                                {% else %}
                                <span class="badge badge-secondary">
                                    <svg class="w-3 h-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                                    B2C
                                </span>
                                {% endif %}
                            </td>
                            <td>
                                <div class="text-sm">
                                    <div>{{ client.email }}</div>
                                    <div class="text-gray-600">{{ client.phone }}</div>
                                </div>
                            </td>
                            <td>{{ client.payment_terms|default:"-" }}</td>
                            <td>{{ client.total_jobs }}</td>
                            <td class="text-sm text-gray-600">{{ client.get_last_activity_display }}</td>
                            <td>
                                {% if client.status == 'Active' %}
                                <span class="badge badge-success">Active</span>
                                {% elif client.status == 'Dormant' %}
                                <span class="badge badge-warning">Dormant</span>
                                {% else %}
                                <span class="badge badge-danger">Inactive</span>
                                {% endif %}
                            </td>
                            <td>
                                <div class="flex gap-2">
                                    <a href="{% url 'client_profile' client.pk %}" class="btn btn-secondary text-sm py-1 px-2">
        <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
        </svg>
    </a>
                                    <a href="{% url 'edit_client' client.pk %}" class="btn btn-secondary text-sm py-1 px-2">
                                        <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                                    </a>
                                </div>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="9" class="text-center text-gray-500 py-8">No clients found</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</div>
{% endblock %}