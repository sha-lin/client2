{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}{{ vendor.name }} - Vendor Profile{% endblock %}

{% block extra_css %}
<style>
    :root {
        --primary-color: #111827; /* Very dark gray/black */
        --secondary-color: #4b5563; /* Medium gray */
        --accent-color: #e5e7eb; /* Light gray for borders/backgrounds */
        --bg-color: #f9fafb; /* Very light gray background */
        --text-main: #1f2937;
        --text-muted: #6b7280;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-main);
    }

    .vendor-header {
        background: white;
        color: var(--text-main);
        padding: 30px;
        border-radius: 8px;
        margin-bottom: 30px;
        border: 1px solid var(--accent-color);
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
    
    .vendor-title {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 20px;
    }
    
    .vendor-name-info h1 {
        font-size: 28px;
        font-weight: 700;
        margin-bottom: 8px;
        color: var(--primary-color);
    }
    
    .vendor-badges {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 15px;
    }
    
    .badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 14px;
        border-radius: 4px; /* More squared for professional look */
        font-size: 12px;
        font-weight: 600;
        background: #f3f4f6;
        color: var(--text-main);
        border: 1px solid #e5e7eb;
    }
    
    .badge.active {
        background: #ecfdf5;
        color: #065f46;
        border-color: #a7f3d0;
    }
    
    .badge.primary {
        background: #eff6ff;
        color: #1e40af;
        border-color: #bfdbfe;
    }
    
    .edit-btn {
        background: white;
        color: var(--text-main);
        padding: 8px 16px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.2s;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }
    
    .edit-btn:hover {
        background: #f9fafb;
        border-color: #9ca3af;
    }
    
    .performance-score {
        background: white;
        padding: 24px;
        border-radius: 8px;
        margin-bottom: 24px;
        border: 1px solid var(--accent-color);
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        text-align: center;
    }
    
    .score-large {
        font-size: 48px;
        font-weight: 700;
        color: var(--primary-color);
        margin: 10px 0;
    }
    
    .score-grade {
        font-size: 14px;
        color: var(--text-muted);
        margin-bottom: 20px;
    }
    
    .score-metrics {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid var(--accent-color);
    }
    
    .metric-item {
        text-align: center;
    }
    
    .metric-value {
        font-size: 20px;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 4px;
    }
    
    .metric-label {
        font-size: 12px;
        color: var(--text-muted);
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .metric-bar {
        background: #e5e7eb;
        height: 6px;
        border-radius: 3px;
        margin-top: 8px;
        overflow: hidden;
    }
    
    .metric-bar-fill {
        height: 100%;
        background: var(--secondary-color);
        transition: width 0.3s;
    }
    
    .two-column {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
        margin-bottom: 24px;
    }
    
    .card {
        background: white;
        padding: 24px;
        border-radius: 8px;
        border: 1px solid var(--accent-color);
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
    
    .card h2 {
        font-size: 16px;
        font-weight: 600;
        color: var(--primary-color);
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
        padding-bottom: 12px;
        border-bottom: 1px solid #f3f4f6;
    }
    
    .card h2 i {
        color: var(--secondary-color);
    }
    
    .info-group {
        margin-bottom: 16px;
        padding-bottom: 16px;
        border-bottom: 1px solid #f9fafb;
    }
    
    .info-group:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
    }
    
    .info-label {
        font-size: 12px;
        color: var(--text-muted);
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 4px;
    }
    
    .info-value {
        font-size: 14px;
        color: var(--text-main);
        font-weight: 500;
    }
    
    .info-value a {
        color: var(--text-main);
        text-decoration: underline;
        text-decoration-color: #d1d5db;
        text-underline-offset: 2px;
    }
    
    .info-value a:hover {
        color: black;
        text-decoration-color: black;
    }
    
    .services-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }
    
    .service-tag {
        background: #f3f4f6;
        color: var(--text-main);
        padding: 6px 12px;
        border-radius: 4px;
        font-size: 13px;
        font-weight: 500;
        border: 1px solid #e5e7eb;
    }
    
    .statistics {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 16px;
    }
    
    .stat-item {
        background: white;
        color: var(--text-main);
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        border: 1px solid var(--accent-color);
    }
    
    .stat-value {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 4px;
        color: var(--primary-color);
    }
    
    .stat-label {
        font-size: 12px;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .quick-actions {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 16px;
    }
    
    .action-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        padding: 20px;
        background: white;
        border: 1px solid var(--accent-color);
        border-radius: 8px;
        cursor: pointer;
        text-decoration: none;
        color: var(--text-main);
        font-size: 13px;
        font-weight: 500;
        transition: all 0.2s;
    }
    
    .action-btn:hover {
        background: #f9fafb;
        border-color: #d1d5db;
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    
    .action-btn i {
        font-size: 24px;
        color: var(--secondary-color);
    }
    
    .internal-notes {
        background: #fffbeb;
        border: 1px solid #fcd34d;
        padding: 20px;
        border-radius: 8px;
        margin-top: 24px;
    }
    
    .internal-notes-title {
        font-weight: 600;
        color: #92400e;
        font-size: 13px;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .internal-notes-content {
        font-size: 14px;
        color: #78350f;
        line-height: 1.6;
    }
    
    .internal-notes-meta {
        font-size: 11px;
        color: #b45309;
        margin-top: 12px;
        border-top: 1px solid #fde68a;
        padding-top: 8px;
    }
    
    .back-link {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        color: var(--text-muted);
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 24px;
        transition: all 0.2s;
    }
    
    .back-link:hover {
        color: var(--primary-color);
        transform: translateX(-4px);
    }
    
    .star {
        color: #111827; /* Black stars */
        font-size: 16px;
    }
    
    @media (max-width: 768px) {
        .two-column {
            grid-template-columns: 1fr;
        }
        
        .score-metrics {
            grid-template-columns: 1fr;
        }
        
        .statistics {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .quick-actions {
            grid-template-columns: repeat(2, 1fr);
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="p-8 max-w-6xl mx-auto">
    <!-- Back Link -->
    <a href="{% url 'vendor_list' %}" class="back-link">
        <i class="fas fa-arrow-left"></i> Back to Vendors
    </a>
    
    <!-- Vendor Header -->
    <div class="vendor-header">
        <div class="vendor-title">
            <div class="vendor-name-info">
                <h1>{{ vendor.name }}</h1>
                <div class="vendor-badges">
                    {% if vendor.active %}
                    <span class="badge active">
                        <i class="fas fa-circle" style="font-size: 8px; margin-right: 4px;"></i> Active
                    </span>
                    {% endif %}
                    {% if vendor.recommended %}
                    <span class="badge primary">
                        <i class="fas fa-star" style="font-size: 10px; margin-right: 4px;"></i> Primary Vendor
                    </span>
                    {% endif %}
                    <span class="badge">
                        VPS Score: {{ vendor.vps_score }}
                    </span>
                </div>
                <div style="font-size: 13px; color: #6b7280; margin-top: 8px;">
                    Last Updated: {{ vendor.updated_at|date:"M d, Y \a\t H:i" }}
                </div>
            </div>
            <a href="{% url 'vendor_profile' vendor.id %}" class="edit-btn">
                <i class="fas fa-pen"></i> Edit Profile
            </a>
        </div>
    </div>
    
    <!-- Performance Score -->
    <div class="performance-score">
        <div style="color: #4b5563; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">
            Performance Score
        </div>
        <div class="score-large">{{ vendor.vps_score_value|floatformat:1 }}/10</div>
        <div class="score-grade">Grade: <strong>{{ vendor.get_vps_score_display }}</strong></div>
        
        <div class="score-metrics">
            <div class="metric-item">
                <div class="metric-value">{{ vendor.rating|floatformat:1 }}</div>
                <div class="metric-label">Overall Rating</div>
                <div style="margin-top: 8px;">
                    <span class="star">★★★★★</span>
                </div>
            </div>
            <div class="metric-item">
                <div class="metric-value">—</div>
                <div class="metric-label">On-Time Delivery</div>
                <div class="metric-bar">
                    <div class="metric-bar-fill" style="width: 0%; background-color: #1f2937;"></div>
                </div>
            </div>
            <div class="metric-item">
                <div class="metric-value">—</div>
                <div class="metric-label">Quality Score</div>
                <div class="metric-bar">
                    <div class="metric-bar-fill" style="width: 0%; background-color: #4b5563;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Two Column Layout -->
    <div class="two-column">
        <!-- Contact Information -->
        <div class="card">
            <h2>
                <i class="fas fa-address-card"></i> Contact Information
            </h2>
            
            <div class="info-group">
                <div class="info-label">Contact Person</div>
                <div class="info-value">{{ vendor.contact_person|default:"Not set" }}</div>
            </div>
            
            <div class="info-group">
                <div class="info-label">Email Address</div>
                <div class="info-value">
                    <a href="mailto:{{ vendor.email }}">
                        {{ vendor.email }}
                    </a>
                </div>
            </div>
            
            <div class="info-group">
                <div class="info-label">Phone Number</div>
                <div class="info-value">
                    <a href="tel:{{ vendor.phone }}">
                        {{ vendor.phone }}
                    </a>
                </div>
            </div>
            
            <div class="info-group">
                <div class="info-label">Business Address</div>
                <div class="info-value">
                    {{ vendor.business_address|default:"Not provided" }}
                </div>
            </div>
        </div>
        
        <!-- Business Details -->
        <div class="card">
            <h2>
                <i class="fas fa-building"></i> Business Details
            </h2>
            
            <div class="info-group">
                <div class="info-label">Tax PIN</div>
                <div class="info-value">{{ vendor.tax_pin|default:"Not provided" }}</div>
            </div>
            
            <div class="info-group">
                <div class="info-label">Payment Terms</div>
                <div class="info-value">{{ vendor.get_payment_terms_display|default:"Not set" }}</div>
            </div>
            
            <div class="info-group">
                <div class="info-label">Payment Method</div>
                <div class="info-value">{{ vendor.get_payment_method_display|default:"Not set" }}</div>
            </div>
            
            <div class="info-group">
                <div class="info-label">Rush Capable</div>
                <div class="info-value">
                    {% if vendor.rush_capable %}
                    <span style="color: #059669; font-weight: 600;">Yes</span>
                    {% else %}
                    <span style="color: #dc2626; font-weight: 600;">No</span>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Services Offered -->
    <div class="card" style="margin-bottom: 24px;">
        <h2>
            <i class="fas fa-layer-group"></i> Services Offered
        </h2>
        
        {% if vendor.services %}
        <div class="services-list">
            {% for service in vendor.services|split:"," %}
            <span class="service-tag">{{ service }}</span>
            {% endfor %}
        </div>
        {% else %}
        <div style="color: #6b7280; font-size: 14px; font-style: italic;">
            No services specified yet.
        </div>
        {% endif %}
        
        {% if vendor.specialization %}
        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #f3f4f6;">
            <div class="info-label" style="margin-bottom: 8px;">Specialization</div>
            <div class="info-value" style="color: #374151; font-weight: 400; line-height: 1.5;">
                {{ vendor.specialization }}
            </div>
        </div>
        {% endif %}
    </div>
    
    <!-- Capacity -->
    <div class="two-column">
        <div class="card">
            <h2>
                <i class="fas fa-cubes"></i> Capacity
            </h2>
            
            <div class="info-group">
                <div class="info-label">Minimum Order Value</div>
                <div class="info-value">KES {{ vendor.minimum_order|default:0|floatformat:2 }}</div>
            </div>
            
            <div class="info-group">
                <div class="info-label">Standard Lead Time</div>
                <div class="info-value">{{ vendor.lead_time|default:"Not specified" }}</div>
            </div>
        </div>
        
        <!-- Initial Rating -->
        <div class="card">
            <h2>
                <i class="fas fa-clipboard-check"></i> Initial Rating
            </h2>
            
            <div class="info-group">
                <div class="info-label">Overall Quality</div>
                <div class="info-value">
                    <select style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 4px; font-weight: 500; width: 100%; background-color: #f9fafb;">
                        <option {% if vendor.quality_rating == 'Excellent' %}selected{% endif %}>Excellent</option>
                        <option {% if vendor.quality_rating == 'Very Good' %}selected{% endif %}>Very Good</option>
                        <option {% if vendor.quality_rating == 'Good' %}selected{% endif %}>Good</option>
                        <option {% if vendor.quality_rating == 'Fair' %}selected{% endif %}>Fair</option>
                    </select>
                </div>
            </div>
            
            <div class="info-group">
                <div class="info-label">Reliability</div>
                <div class="info-value">
                    <select style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 4px; font-weight: 500; width: 100%; background-color: #f9fafb;">
                        <option {% if vendor.reliability_rating == 'Excellent' %}selected{% endif %}>Excellent</option>
                        <option {% if vendor.reliability_rating == 'Very Good' %}selected{% endif %}>Very Good</option>
                        <option {% if vendor.reliability_rating == 'Good' %}selected{% endif %}>Good</option>
                        <option {% if vendor.reliability_rating == 'Fair' %}selected{% endif %}>Fair</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Statistics -->
    <div class="card" style="margin-bottom: 24px;">
        <h2>
            <i class="fas fa-chart-pie"></i> Statistics
        </h2>
        <div class="statistics">
            <div class="stat-item">
                <div class="stat-value">—</div>
                <div class="stat-label">Total Jobs</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">—</div>
                <div class="stat-label">This Month</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">—</div>
                <div class="stat-label">Total Spend (KES)</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">—</div>
                <div class="stat-label">Last Order</div>
            </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="card" style="margin-bottom: 24px;">
        <h2>
            <i class="fas fa-mouse-pointer"></i> Quick Actions
        </h2>
        <div class="quick-actions">
            <a href="#" class="action-btn">
                <i class="fas fa-pen-square"></i> Edit Profile
            </a>
            <a href="#" class="action-btn">
                <i class="fas fa-plus-square"></i> Create Order
            </a>
            <a href="#" class="action-btn">
                <i class="fas fa-file-alt"></i> View Reports
            </a>
            <a href="#" class="action-btn">
                <i class="fas fa-envelope-open-text"></i> Send Message
            </a>
        </div>
    </div>
    
    <!-- Internal Notes -->
    {% if vendor.internal_notes %}
    <div class="internal-notes">
        <div class="internal-notes-title">
            <i class="fas fa-lock"></i> Internal Notes
            <span style="font-size: 10px; font-weight: 500; margin-left: auto; color: #b45309; border: 1px solid #fcd34d; padding: 2px 6px; border-radius: 4px;">PRIVATE</span>
        </div>
        <div class="internal-notes-content">
            {{ vendor.internal_notes }}
        </div>
        <div class="internal-notes-meta">
            Last updated: {{ vendor.internal_notes_updated|date:"M d, Y \a\t H:i" }}
        </div>
    </div>
    {% endif %}
    
</div>
{% endblock %}