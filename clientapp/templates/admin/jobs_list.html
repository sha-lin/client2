{% extends 'admin/generic_list.html' %}
{% load humanize %}

{% block filter_controls %}
<select name="status" class="filter-select" onchange="this.form.submit()">
    <option value="">All Status</option>
    <option value="pending" {% if status == 'pending' %}selected{% endif %}>Pending</option>
    <option value="in_progress" {% if status == 'in_progress' %}selected{% endif %}>In Progress</option>
    <option value="completed" {% if status == 'completed' %}selected{% endif %}>Completed</option>
    <option value="on_hold" {% if status == 'on_hold' %}selected{% endif %}>On Hold</option>
</select>
{% endblock %}

{% block table_header %}
<tr>
    <th width="40"><input type="checkbox" id="select-all"></th>
    <th>Job Number</th>
    <th>Quote</th>
    <th>Description</th>
    <th>Status</th>
    <th>Expected Completion</th>
    <th>Created</th>
    <th>Actions</th>
</tr>
{% endblock %}

{% block table_body %}
{% for job in page_obj %}
<tr>
    <td><input type="checkbox" name="selected_ids" value="{{ job.pk }}" class="row-checkbox"></td>
    <td><a href="{% url 'admin_job_detail' job.pk %}" style="color: #3b82f6; text-decoration: none; font-weight: bold;">{{ job.job_number }}</a></td>
    <td>{{ job.quote.quote_id|default:"-" }}</td>
    <td>{{ job.job_name|truncatewords:5|default:"-" }}</td>
    <td>
        <span class="badge 
            {% if job.status == 'completed' %}badge-success
            {% elif job.status == 'in_progress' %}badge-info
            {% elif job.status == 'pending' %}badge-warning
            {% else %}badge-danger
            {% endif %}">
            {{ job.status|title|default:"Pending" }}
        </span>
    </td>
    <td>{{ job.expected_completion|date:"M d, Y"|default:"-" }}</td>
    <td>{{ job.created_at|date:"M d, Y" }}</td>
    <td>
        <div class="row-actions">
            <a href="{% url 'admin_job_detail' job.pk %}" class="action-btn">Edit</a>
            <a href="{% url 'admin_job_delete' job.pk %}" class="action-btn danger">Delete</a>
        </div>
    </td>
</tr>
{% empty %}
<tr>
    <td colspan="8" style="text-align:center; padding:20px;">No jobs found</td>
</tr>
{% endfor %}
{% endblock %}